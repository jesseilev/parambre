(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{51:function(e,t,n){e.exports=n(90)},90:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(16),i=n(19),u=n(12),d=n(38),s=n(6),c=n(7),l="undefined"!==typeof window?new AudioContext:{},m=n(5),h=n(30),p=n(98),g=function(e,t){var n=e.offset,a=e.amp,r=e.period,o=e.phase;return n+a*Math.sin(2*Math.PI*t/r+o)},v=function(e,t){return{min:e,max:t}},f=function(e){return e.max-e.min},b=function(e,t,n){var a=(n-e.min)/f(e);return t.min+a*f(t)},y=Object(c.a)(function(e){var t=e.gain,n=e.pulseFrequency,a=e.pulseAmplitiude,r=Object(h.a)(e,["gain","pulseFrequency","pulseAmplitiude"]);return{0:Object(c.c)("output",{gain:t}),1:Object(c.d)(0,Object(m.a)({},r)),2:Object(c.c)({key:0,destination:"gain"},{gain:a}),3:Object(c.d)(2,{frequency:n,type:"saw"})}}),P=Object(c.a)(function(e){var t=e.rootFrequency,n=e.toneCount,a=e.overtoneAmp,r=e.overtoneModulationFreq,o=e.overtoneModulationAmp,i=Object(h.a)(e,["rootFrequency","toneCount","overtoneAmp","overtoneModulationFreq","overtoneModulationAmp"]);return p.a(1,n+1).filter(function(e){return e*t<22050}).reduce(function(e,u){var d=t*u,s=a(u,d)/(u*n);return e[u]=y("output",Object(m.a)({frequency:d,gain:s,pulseFrequency:r(u),pulseAmplitiude:o(u)*s},i)),e},{})}),A=function(e){var t=function(e){var t=e.settings.synth,n=t.attack,a=t.release,r=(t.toneCount,t.rootFrequency),o=(e.audioPlayer.audioGraph||0).currentTime,i=e.audioPlayer.isPlaying?1:0,u=e.audioPlayer.isPlaying?n:a,d=e.audioPlayer.mostRecentPlayPauseChange+u,s=o<d,l=s?"linearRampToValueAtTime":"setValueAtTime";d=s?d:o;var m=e.timbreParams,h=m.overtoneAmplitudesCurve,p=m.modulationMagnitudesCurve,v=m.modulationFrequenciesCurve,f=function(t){return P(0,{rootFrequency:t,toneCount:e.settings.synth.toneCount,overtoneAmp:function(e){return g(h,e)},overtoneModulationAmp:function(e){return g(p,e)},overtoneModulationFreq:function(e){return 1+16*g(v,e)}})};return{0:Object(c.c)("output",{gain:[l,i,d]}),1:f(1*r),3:f(12*r/5),4:f(9*r/5)}}(e);e.audioPlayer.audioGraph.update(t)},O=n(13),S=n(94),x=n(95),j=n(49),w=(n(88),function(e){return{type:"BOX_ADJUSTMENT",params:e}}),E={width:20,height:20,background:"#ddd"},M=Object(O.withSize)({monitorHeight:!0})(function(e){var t=e.xParam,n=e.yParam,a=e.widthParam,o=e.heightParam,i=e.parentSize,u=e.zIndex,d=e.paramSetName,s=e.boxBeingAdjusted,c=e.onDrag,l=e.onResize,m=e.onBoxAdjustmentStart,h=e.onBoxAdjustmentStop,p=b(t.range,v(0,i.width),t.value),g=b(n.range,v(0,i.height),n.value),f=b(a.range,v(0,i.width),a.value),y=b(o.range,v(0,i.height),o.value);return r.a.createElement(j.a,{position:{x:p-.5*f,y:g-.5*y},size:{width:f,height:y},bounds:"parent",maxWidth:.5*i.width,maxHeight:i.height,minWidth:60,minHeight:60,style:{border:"5px solid #ddd",background:"ME"===s?"rgba(0,0,0,0)":e.color,opacity:"SOMEONE_ELSE"===s?0:1,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"10px 10px 20px 2px rgba(0,0,0,0.2)",zIndex:u},onDrag:c(i,t,n),onResize:l(i,a,o),onDragStart:m(d),onDragStop:h(d),onResizeStart:m(d),onResizeStop:h(d),enableResizing:{topLeft:!0,topRight:!0,bottomLeft:!0,bottomRight:!0},resizeHandleStyles:{topLeft:E,topRight:E,bottomLeft:E,bottomRight:E}})}),C=Object(u.b)(function(e,t){var n=e.timbreParams.currentParamSetBeingAdjusted,a=null;return n===t.paramSetName?a="ME":null!==n&&(a="SOMEONE_ELSE"),{boxBeingAdjusted:a}},function(e){return{onDrag:function(t,n,a){return function(r,o){var i=b(v(0,t.width),v(0,f(n.range)),o.deltaX),u=b(v(0,t.height),v(0,f(a.range)),o.deltaY);return e(w([Object(m.a)({},n,{value:n.value+i}),Object(m.a)({},a,{value:a.value+u})]))}},onResize:function(t,n,a){return function(r,o,i,u,d){var s=b(v(0,t.width),n.range,i.clientWidth),c=b(v(0,t.height),a.range,i.clientHeight);return e(w([Object(m.a)({},n,{value:s}),Object(m.a)({},a,{value:c})]))}},onBoxAdjustmentStart:function(t){return function(){return e(function(e){return{type:"BOX_ADJUSTMENT_START",paramSetName:e}}(t))}},onBoxAdjustmentStop:function(t){return function(){return e(function(e){return{type:"BOX_ADJUSTMENT_STOP",paramSetName:e}}(t))}}}})(M),T=n(43),B=n(44),q=n(47),F=n(45),_=n(48),z=function(e){function t(e){var n;return Object(T.a)(this,t),(n=Object(q.a)(this,Object(F.a)(t).call(this,e))).canvas=r.a.createRef(),n}return Object(_.a)(t,e),Object(B.a)(t,[{key:"render",value:function(){return r.a.createElement("canvas",{width:this.props.parentSize.width,height:this.props.parentSize.height,ref:this.canvas})}},{key:"draw",value:function(){var e=this.props,t=e.overtones,n=e.isPlaying,a=e.colors,r=this.canvas.current,o=r.getContext("2d"),i=r.width/(t.length+4),u=.5*r.height,d=.05*r.width;o.clearRect(0,0,r.width,r.height),n&&t.map(function(e,t){var n=e.overtoneAmplitude,r=e.modulationMagnitude,s=e.modulationFrequency,c=(t+2+.5)*i,l=n*u+.5*u;o.lineWidth=4,o.strokeStyle=a.modulationMagnitudes,o.beginPath();var m=r*u;o.moveTo(c,l-.5*m),o.lineTo(c,l+.5*m),o.stroke(),o.lineWidth=4,o.fillStyle=a.overtoneAmplitudes,o.beginPath(),o.arc(c,l,8,2*Math.PI,!1),o.fill(),o.strokeStyle=a.modulationFrequencies,o.lineWidth=4,o.beginPath();var h=Math.max((1-s)*d,0);o.arc(c,l,h,2*Math.PI,!1),o.stroke()})}},{key:"componentDidUpdate",value:function(){this.draw()}}]),t}(a.Component),D=function(e){return p.a(1,e.settings.synth.toneCount+1).map(function(t){return{overtoneAmplitude:g(e.timbreParams.overtoneAmplitudesCurve,t),modulationMagnitude:g(e.timbreParams.modulationMagnitudesCurve,t),modulationFrequency:g(e.timbreParams.modulationFrequenciesCurve,t)}})},R=Object(u.b)(function(e){return{overtones:D(e),isPlaying:e.audioPlayer.isPlaying,colors:e.settings.colors}})(z),N=n(91),U=n(97),k=n(96),I=n(46),X=n(92),H=n(93),J={overtoneAmplitudesCurve:{ranges:{phase:v(0,18),offset:v(0,1),period:v(2,20),amp:v(0,1)}},modulationMagnitudesCurve:{ranges:{phase:v(0,18),offset:v(0,1),period:v(2,20),amp:v(0,1)}},modulationFrequenciesCurve:{ranges:{phase:v(0,18),offset:v(0,1),period:v(2,20),amp:v(0,1)}}},L=function(e){var t=function(e,t){return b(v(0,1),e,t)},n=function(e,n){return t(v(e,n),Math.random())};return{phase:t(e.phase,n(.25,.75)),offset:t(e.offset,n(.4,.6)),period:t(e.period,n(.1,.4)),amp:t(e.amp,n(.3,.8))}},G={overtoneAmplitudesCurve:L(J.overtoneAmplitudesCurve.ranges),modulationMagnitudesCurve:L(J.modulationMagnitudesCurve.ranges),modulationFrequenciesCurve:L(J.modulationFrequenciesCurve.ranges),currentParamSetBeingAdjusted:null},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"BOX_ADJUSTMENT":var n=I.a(function(e){var t=e.value,n=e.lensPath;return N.a(U.a(k.a(n),t))},t.params),a=X.a(H.a,e,n);return Object(s.d)(a,s.a.action({type:"GRAPH_UPDATE"}));case"BOX_ADJUSTMENT_START":return Object(m.a)({},e,{currentParamSetBeingAdjusted:t.paramSetName});case"BOX_ADJUSTMENT_STOP":return Object(m.a)({},e,{currentParamSetBeingAdjusted:null});default:return e}},V=function(e){var t=e.width,n=e.height;return b(t.range,v(0,1),t.value)*b(n.range,v(0,1),n.value)},Y=function(e,t){return S.a(x.a(V,e)).indexOf(t)},K=Object(O.withSize)({monitorHeight:!0})(function(e){var t=e.overtoneAmplitudesBox,n=e.modulationMagnitudesBox,a=e.modulationFrequenciesBox,o=[t,n,a];return r.a.createElement("div",{style:{width:"100%",height:"100%",borderColor:"white",borderStyle:"dashed",borderWidth:(e.isAdjustmentHappening,"0px")}},r.a.createElement(C,{parentSize:e.size,xParam:e.overtoneAmplitudesBox.x,yParam:e.overtoneAmplitudesBox.y,widthParam:e.overtoneAmplitudesBox.width,heightParam:e.overtoneAmplitudesBox.height,zIndex:Y(o,t),color:e.colors.overtoneAmplitudes,paramSetName:"overtoneAmplitudes"}),r.a.createElement(C,{parentSize:e.size,xParam:e.modulationMagnitudesBox.x,yParam:e.modulationMagnitudesBox.y,widthParam:e.modulationMagnitudesBox.width,heightParam:e.modulationMagnitudesBox.height,color:e.colors.modulationMagnitudes,paramSetName:"modulationMagnitudes",zIndex:Y(o,n)}),r.a.createElement(C,{parentSize:e.size,xParam:e.modulationFrequenciesBox.x,yParam:e.modulationFrequenciesBox.y,widthParam:e.modulationFrequenciesBox.width,heightParam:e.modulationFrequenciesBox.height,color:e.colors.modulationFrequencies,paramSetName:"modulationFrequencies",zIndex:Y(o,a)}))}),Q=Object(u.b)(function(e){var t=function(e,t,n){return{x:{value:e.phase,range:t.ranges.phase,lensPath:[n,"phase"]},y:{value:e.offset,range:t.ranges.offset,lensPath:[n,"offset"]},width:{value:e.period,range:t.ranges.period,lensPath:[n,"period"]},height:{value:e.amp,range:t.ranges.amp,lensPath:[n,"amp"]}}};return{overtoneAmplitudesBox:t(e.timbreParams.overtoneAmplitudesCurve,J.overtoneAmplitudesCurve,"overtoneAmplitudesCurve"),modulationMagnitudesBox:t(e.timbreParams.modulationMagnitudesCurve,J.modulationMagnitudesCurve,"modulationMagnitudesCurve"),modulationFrequenciesBox:t(e.timbreParams.modulationFrequenciesCurve,J.modulationFrequenciesCurve,"modulationFrequenciesCurve"),colors:e.settings.colors,isAdjustmentHappening:null!==e.timbreParams.currentParamSetBeingAdjusted}},function(e){return{}})(K),Z=Object(O.withSize)({monitorHeight:!0})(function(e){return r.a.createElement("div",{style:{width:"100%",height:"100vh",background:"#111"}},r.a.createElement(R,{parentSize:e.size}),r.a.createElement("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}},r.a.createElement(Q,null)))}),$=Object(u.b)()(Z),ee=function(){return r.a.createElement("div",null,r.a.createElement($,null))},te=Object(c.b)({audioContext:l,output:l.destination});te.update({0:Object(c.c)("output",{gain:0})});var ne={isPlaying:!1,mostRecentPlayPauseChange:0,audioGraph:te},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=function(t){var n=Object(m.a)({},e,{isPlaying:t,mostRecentPlayPauseChange:e.audioGraph.currentTime});return Object(s.d)(n,s.a.action({type:"GRAPH_UPDATE"}))};switch((arguments.length>1?arguments[1]:void 0).type){case"TOGGLE_PLAYBACK":return t(!e.isPlaying);case"BOX_ADJUSTMENT_START":return t(!0);case"BOX_ADJUSTMENT_STOP":return t(!1);default:return e}},re=new Uint8Array,oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FFT_UPDATE":return t.frequencyData;default:return e}},ie={timbreParams:G,audioPlayer:ne,frequencyData:re,settings:Object(m.a)({},J,{colors:{overtoneAmplitudes:"#f50",modulationMagnitudes:"#309",modulationFrequencies:"#737"},synth:{attack:.5,release:3,toneCount:16,rootFrequency:180,chord:[1,1.8,2.4,16/3]}})},ue=Object(i.c)(Object(i.a)(Object(d.ReduxEmitter)()),s.c(),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),de=Object(i.d)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GRAPH_UPDATE":return Object(s.d)(e,s.a.run(function(){return A(e)}));default:return Object(s.b)({timbreParams:W,audioPlayer:ae,frequencyData:oe})(e,t)}},ie,ue);Object(o.render)(r.a.createElement(u.a,{store:de},r.a.createElement(ee,null)),document.getElementById("root")),de.subscribe(function(){de.getState()})}},[[51,2,1]]]);
//# sourceMappingURL=main.2c7c3b67.chunk.js.map